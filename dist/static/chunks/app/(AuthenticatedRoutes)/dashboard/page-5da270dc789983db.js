(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[458],{7676:(e,t,a)=>{Promise.resolve().then(a.bind(a,8974))},8974:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5155),n=a(2115),o=a(3391),s=a(2670);function i(){let{isAuthenticated:e,loading:t}=function(){let e=(0,o.wA)(),{user:t,loading:a,isAuthenticated:r}=(0,o.d4)(e=>e.auth);return(0,n.useEffect)(()=>{e((0,s.T5)())},[e]),{user:t,loading:a,isAuthenticated:r}}();return t?(0,r.jsx)("div",{children:"Loading..."}):e?(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Dashboard"}),(0,r.jsx)("p",{className:"mt-4 text-muted-foreground",children:"This is a protected route. You can only see this if you're authenticated."})]}):(0,r.jsx)("div",{children:"You are not authenticated. Please log in."})}},2670:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>l,T5:()=>o,iD:()=>s,ri:()=>i});var r=a(8943),n=a(9050);let o=(0,r.zD)("auth/checkAuth",async(e,t)=>{let{rejectWithValue:a}=t;try{if(!await n.SK())throw Error("Token is invalid");return{id:"1",email:"user@example.com",name:"User"}}catch(e){return a(e.message)}}),s=(0,r.zD)("auth/login",async e=>{var t;let a=await n.iD(e);if(!a.success)throw Error(a.message);return null===(t=a.data)||void 0===t?void 0:t.user}),i=(0,r.zD)("auth/logout",async()=>{await n.ri()}),l=(0,r.Z0)({name:"auth",initialState:{user:null,loading:!1,error:null,isAuthenticated:!1},reducers:{},extraReducers:e=>{e.addCase(o.pending,e=>{e.loading=!0}).addCase(o.fulfilled,(e,t)=>{e.loading=!1,e.user=t.payload||null,e.isAuthenticated=!!t.payload}).addCase(o.rejected,e=>{e.loading=!1,e.user=null}).addCase(s.pending,e=>{e.loading=!0,e.error=null}).addCase(s.fulfilled,(e,t)=>{e.loading=!1,e.user=t.payload||null,e.isAuthenticated=!0}).addCase(s.rejected,(e,t)=>{var a;e.loading=!1,e.error=null!==(a=t.error.message)&&void 0!==a?a:"Login failed"}).addCase(i.fulfilled,e=>{e.user=null,e.isAuthenticated=!1})}}).reducer},9050:(e,t,a)=>{"use strict";a.d(t,{SK:()=>f,BD:()=>d,iD:()=>l,ri:()=>u,kz:()=>i,xw:()=>c,A$:()=>h});var r,n=a(2651);let o=null!==(r=a(2818).env.NEXT_PUBLIC_API_URL)&&void 0!==r?r:"https://falcon-api.lyticaltechserver.com/api",s=n.A.create({baseURL:o,headers:{"Content-Type":"application/json"}});async function i(e){return(await s.post("/Auth/register",e)).data}async function l(e){let t=await s.post("/Auth/login",e);return t.data.success&&t.data.data&&(localStorage.setItem("auth-token",t.data.data.token),localStorage.setItem("refresh-token",t.data.data.refreshToken)),t.data}async function u(){await s.delete("/Auth/logout"),localStorage.removeItem("auth-token"),localStorage.removeItem("refresh-token")}async function d(e){return(await s.post("/Auth/forgot-password",{email:e})).data}async function c(e){return(await s.post("/Auth/reset-password",e)).data}async function h(e,t){return(await s.post("/Auth/email-verify",{verificationCode:e,email:t})).data}async function f(){try{return await s.get("/Auth/refresh-token"),!0}catch(e){return!1}}s.interceptors.request.use(async e=>{let t=localStorage.getItem("auth-token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{let t=e.config;if(401===e.response.status&&!t._retry){t._retry=!0;try{let e=localStorage.getItem("refresh-token"),{token:a}=(await n.A.post("".concat(o,"/Auth/refresh-token"),{refreshToken:e})).data;return localStorage.setItem("auth-token",a),t.headers.Authorization="Bearer ".concat(a),s(t)}catch(e){localStorage.removeItem("auth-token"),localStorage.removeItem("refresh-token"),window.location.href="/login"}}return Promise.reject(e)})}},e=>{var t=t=>e(e.s=t);e.O(0,[651,505,441,517,358],()=>t(7676)),_N_E=e.O()}]);